{% extends "base.html" %}
{% load static %}
{% block title %}Insumos{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h3>Insumos</h3>
  <input id="q" class="form-control searchbar" placeholder="Buscar insumo...">
</div>

<div class="table-responsive">
<table class="table table-striped align-middle" id="tbl">
  <thead>
    <tr>
      <th>ID</th><th>Nombre</th><th>Categoría</th><th>Unidad</th>
      <th class="text-end">Stock</th><th class="text-end">Mínimo</th><th>Estado</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>
</div>

<script>
document.addEventListener('DOMContentLoaded', async () => {
  const data = await SecretoUI.loadJSON("{% static 'mock/insumos.json' %}");
  const tbody = document.querySelector("#tbl tbody");
  tbody.innerHTML = data.map(r => `
    <tr>
      <td>${r.id}</td>
      <td>${r.nombre}</td>
      <td>${r.categoria}</td>
      <td>${r.unidad}</td>
      <td class="text-end">${r.stock}</td>
      <td class="text-end">${r.stock_min}</td>
      <td>${SecretoUI.statusBadgeStock(r)}</td>
    </tr>
  `).join("");
  SecretoUI.simpleSearch(document.getElementById('q'), document.getElementById('tbl'));
});
</script>
{% endblock %}
